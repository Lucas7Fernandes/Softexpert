<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Status Report ‚Äî Implanta√ß√£o Softexpert | Plano&Plano</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=DM+Serif+Display&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
:root{--navy:#1B2A4A;--navy-light:#2A3F6B;--navy-dark:#111C33;--coral:#E8584F;--coral-light:#FF7A72;--bg:#F4F3F0;--bg-card:#FFFFFF;--bg-subtle:#ECEAE6;--text:#1B2A4A;--text-secondary:#6B7280;--text-light:#9CA3AF;--green:#10B981;--green-bg:#ECFDF5;--yellow:#F59E0B;--yellow-bg:#FFFBEB;--red:#EF4444;--red-bg:#FEF2F2;--blue:#3B82F6;--blue-bg:#EFF6FF;--shadow-sm:0 1px 3px rgba(27,42,74,0.06);--shadow-md:0 4px 16px rgba(27,42,74,0.08);--radius:12px;--radius-sm:8px}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);line-height:1.5;overflow-x:hidden}
.header{background:linear-gradient(135deg,var(--navy),var(--navy-dark));padding:32px 48px;position:relative;overflow:hidden}.header::before{content:'';position:absolute;top:-50%;right:-10%;width:500px;height:500px;background:radial-gradient(circle,rgba(232,88,79,0.15),transparent 70%);pointer-events:none}.header::after{content:'';position:absolute;bottom:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--coral),var(--coral-light),var(--coral))}
.header-top{display:flex;justify-content:space-between;align-items:flex-start;position:relative;z-index:1}.header-brand{display:flex;align-items:center;gap:16px}.header-logo{width:44px;height:44px;background:var(--coral);border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:'DM Serif Display',serif;color:white;font-size:20px;font-weight:700}
.header-titles h1{font-family:'DM Serif Display',serif;font-size:26px;color:white;font-weight:400}.header-titles p{color:rgba(255,255,255,0.6);font-size:13px;margin-top:2px}
.header-meta{display:flex;gap:24px;align-items:center}.header-meta-item{text-align:right}.header-meta-item label{display:block;font-size:10px;text-transform:uppercase;letter-spacing:1.2px;color:rgba(255,255,255,0.4);margin-bottom:2px}.header-meta-item span{color:white;font-size:14px;font-weight:500}
.status-badge{display:inline-flex;align-items:center;gap:6px;background:rgba(16,185,129,0.15);color:#6EE7B7;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600}.status-badge::before{content:'';width:6px;height:6px;background:#6EE7B7;border-radius:50%;animation:pulse 2s infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.4}}
.import-btn{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.12);border:1px solid rgba(255,255,255,0.2);color:white;padding:8px 18px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s;font-family:'DM Sans',sans-serif}.import-btn:hover{background:var(--coral);border-color:var(--coral)}.import-btn svg{width:16px;height:16px}
.toast{position:fixed;top:20px;right:20px;color:white;padding:12px 24px;border-radius:8px;font-size:13px;font-weight:600;z-index:999;box-shadow:0 4px 20px rgba(0,0,0,0.2);animation:slideIn 0.3s ease,fadeOut 0.5s ease 2.5s forwards}@keyframes slideIn{from{transform:translateX(100px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes fadeOut{to{opacity:0;transform:translateY(-10px)}}
.nav-tabs{display:flex;gap:4px;padding:12px 48px 0;background:var(--navy-dark);overflow-x:auto}.nav-tab{padding:10px 20px;color:rgba(255,255,255,0.5);font-size:13px;font-weight:500;border:none;background:none;cursor:pointer;border-radius:8px 8px 0 0;transition:all 0.2s;white-space:nowrap;font-family:'DM Sans',sans-serif}.nav-tab:hover{color:rgba(255,255,255,0.8);background:rgba(255,255,255,0.05)}.nav-tab.active{color:var(--text);background:var(--bg);font-weight:600}
.main{padding:32px 48px;max-width:1440px;margin:0 auto}.section-header{display:flex;align-items:center;gap:12px;margin-bottom:20px;margin-top:8px}.section-header h2{font-family:'DM Serif Display',serif;font-size:20px;font-weight:400;color:var(--navy);white-space:nowrap}.section-header .line{flex:1;height:1px;background:var(--bg-subtle)}.section-header .count{font-size:12px;color:var(--text-secondary);background:var(--bg-subtle);padding:4px 10px;border-radius:12px;white-space:nowrap}
.kpi-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:36px}.kpi-card{background:var(--bg-card);border-radius:var(--radius);padding:20px 24px;box-shadow:var(--shadow-sm);border:1px solid rgba(0,0,0,0.04);position:relative;overflow:hidden;transition:box-shadow 0.3s,transform 0.2s}.kpi-card:hover{box-shadow:var(--shadow-md);transform:translateY(-2px)}.kpi-card::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%}.kpi-card.accent-navy::before{background:var(--navy)}.kpi-card.accent-green::before{background:var(--green)}.kpi-card.accent-yellow::before{background:var(--yellow)}.kpi-card.accent-red::before{background:var(--red)}.kpi-card.accent-coral::before{background:var(--coral)}
.kpi-label{font-size:11px;text-transform:uppercase;letter-spacing:1px;color:var(--text-secondary);margin-bottom:8px;font-weight:500}.kpi-value{font-family:'DM Serif Display',serif;font-size:32px;color:var(--navy);line-height:1}.kpi-sub{font-size:12px;color:var(--text-secondary);margin-top:6px}.kpi-sub .up{color:var(--green);font-weight:600}.kpi-sub .down{color:var(--red);font-weight:600}
.card{background:var(--bg-card);border-radius:var(--radius);box-shadow:var(--shadow-sm);border:1px solid rgba(0,0,0,0.04);overflow:hidden}.card-header{padding:18px 24px;border-bottom:1px solid var(--bg-subtle);display:flex;justify-content:space-between;align-items:center}.card-header h3{font-size:15px;font-weight:600;color:var(--navy)}.card-body{padding:24px}
.status-pill{display:inline-flex;align-items:center;gap:5px;padding:4px 12px;border-radius:20px;font-size:11px;font-weight:600}.status-pill.on-track{background:var(--green-bg);color:var(--green)}.status-pill.attention{background:var(--yellow-bg);color:var(--yellow)}.status-pill.critical{background:var(--red-bg);color:var(--red)}.status-pill.completed{background:var(--blue-bg);color:var(--blue)}.status-pill.not-started{background:var(--bg-subtle);color:var(--text-secondary)}.status-pill::before{content:'';width:6px;height:6px;border-radius:50%;background:currentColor}
.gantt-wrapper{overflow-x:auto}.gantt-container{min-width:950px}.gantt-header{display:grid;grid-template-columns:260px 1fr;border-bottom:2px solid var(--bg-subtle);margin-bottom:2px}.gantt-header-label{padding:8px 12px;font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--text-secondary);font-weight:600}.gantt-months{display:grid;grid-template-columns:repeat(18,1fr)}.gantt-month{text-align:center;font-size:9px;color:var(--text-light);padding:8px 0;font-weight:500;text-transform:uppercase;letter-spacing:0.5px}
.gantt-row{display:grid;grid-template-columns:260px 1fr;align-items:center;transition:background 0.15s}.gantt-row:hover{background:rgba(0,0,0,0.015)}.gantt-row.project-row{cursor:pointer}.gantt-row.project-row:hover{background:rgba(27,42,74,0.03)}.gantt-row.phase-row{background:rgba(0,0,0,0.008)}.gantt-row.phase-row .gantt-row-label{padding-left:36px}
.gantt-row-label{padding:9px 12px;display:flex;align-items:center;gap:8px;min-height:40px}.gantt-expand-btn{width:20px;height:20px;border-radius:4px;border:1px solid var(--bg-subtle);background:var(--bg-card);display:flex;align-items:center;justify-content:center;font-size:11px;color:var(--text-secondary);flex-shrink:0;transition:all 0.2s;cursor:pointer;line-height:1}.gantt-expand-btn:hover{border-color:var(--navy);color:var(--navy)}.gantt-expand-btn.expanded{background:var(--navy);color:white;border-color:var(--navy)}
.gantt-row-info{flex:1;min-width:0}.gantt-row-name{font-size:13px;font-weight:600;color:var(--navy);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.gantt-row-area{font-size:10px;color:var(--text-secondary)}.phase-row .gantt-row-name{font-weight:500;font-size:12px;color:var(--text-secondary)}.gantt-row-status{flex-shrink:0}
.gantt-bars{display:grid;grid-template-columns:repeat(18,1fr);position:relative;height:40px;align-items:center}.gantt-bar{border-radius:4px;height:18px;position:absolute;top:11px;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;color:white;letter-spacing:0.3px;transition:all 0.3s;cursor:default}.gantt-bar:hover{height:22px;top:9px;filter:brightness(1.1)}.gantt-bar.completed-bar{background:linear-gradient(90deg,var(--blue),#60A5FA)}.gantt-bar.on-track-bar{background:linear-gradient(90deg,var(--green),#34D399)}.gantt-bar.attention-bar{background:linear-gradient(90deg,var(--yellow),#FBBF24)}.gantt-bar.not-started-bar{background:linear-gradient(90deg,#9CA3AF,#D1D5DB)}
.gantt-bar.phase-bar{height:10px;top:15px;opacity:0.85;border-radius:3px;font-size:0}.gantt-bar.phase-bar:hover{height:14px;top:13px;font-size:8px;opacity:1}
.gantt-today-global{position:absolute;top:0;bottom:0;width:2px;background:var(--coral);z-index:5;pointer-events:none}.gantt-today-global::before{content:'HOJE';position:absolute;top:4px;left:50%;transform:translateX(-50%);font-size:8px;font-weight:700;color:var(--coral);letter-spacing:1px;background:var(--bg-card);padding:0 4px}.gantt-grid-line{position:absolute;top:0;bottom:0;width:1px;background:rgba(0,0,0,0.03)}.gantt-phases-container{overflow:hidden;transition:max-height 0.35s ease,opacity 0.25s ease;max-height:0;opacity:0}.gantt-phases-container.open{max-height:500px;opacity:1}
.org-chart{display:flex;flex-direction:column;align-items:center;gap:0;padding:20px 0}.org-level{display:flex;justify-content:center;gap:32px;position:relative;width:100%;flex-wrap:wrap}.org-connector-v{width:2px;height:24px;background:var(--navy);opacity:0.15;margin:0 auto}.org-card{background:var(--bg-card);border:2px solid var(--bg-subtle);border-radius:var(--radius-sm);padding:16px 20px;text-align:center;min-width:180px;max-width:260px;transition:all 0.2s}.org-card:hover{border-color:var(--navy);box-shadow:var(--shadow-md);transform:translateY(-2px)}.org-card.sponsor{border-color:var(--coral);background:linear-gradient(135deg,#FFF5F5,#FFF)}.org-card.comite{border-color:var(--navy);background:linear-gradient(135deg,#F0F4FF,#FFF)}.org-card.gestao{border-color:var(--navy-light)}.org-card.decisor{border-color:var(--yellow);background:linear-gradient(135deg,#FFFDF5,#FFF)}.org-card .org-role{font-size:9px;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-secondary);font-weight:600;margin-bottom:8px}.org-people-list{display:flex;flex-direction:column;gap:6px}.org-person{display:flex;align-items:center;gap:8px}.org-avatar{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:white;flex-shrink:0}.org-person-info{text-align:left;min-width:0}.org-person-name{font-size:12px;font-weight:600;color:var(--navy);line-height:1.2}.org-person-title{font-size:10px;color:var(--text-secondary);line-height:1.2}
.org-team-box{border:2px solid var(--bg-subtle);border-radius:var(--radius);padding:20px;width:100%;max-width:1000px;background:linear-gradient(135deg,#FAFAF8,#FFF)}.org-team-title{font-size:10px;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-secondary);font-weight:600;margin-bottom:14px;text-align:center}.org-area-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:10px}.org-area-card{background:var(--bg-card);border:1px solid var(--bg-subtle);border-radius:8px;padding:12px 14px;transition:all 0.2s}.org-area-card:hover{border-color:var(--navy-light);box-shadow:var(--shadow-sm)}.org-area-label{font-size:9px;text-transform:uppercase;letter-spacing:0.8px;color:var(--text-light);font-weight:600;margin-bottom:8px}.org-area-members{display:flex;flex-direction:column;gap:4px}.org-area-member{display:flex;align-items:center;gap:6px}.org-area-member-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}.org-area-member-name{font-size:11px;font-weight:500;color:var(--navy)}.org-area-member-role{font-size:10px;color:var(--text-secondary)}
.raci-wrapper{overflow-x:auto}.raci-table{width:100%;border-collapse:collapse;min-width:800px}.raci-table thead th{text-align:center;font-size:10px;text-transform:uppercase;letter-spacing:0.8px;color:var(--text-secondary);padding:10px 8px;border-bottom:2px solid var(--bg-subtle);font-weight:600;background:var(--bg-card)}.raci-table thead th:first-child{text-align:left;min-width:200px;text-transform:none}.raci-table tbody td{text-align:center;padding:10px 8px;border-bottom:1px solid rgba(0,0,0,0.04);font-size:13px}.raci-table tbody td:first-child{text-align:left;font-weight:500;color:var(--navy)}.raci-table tbody tr:hover{background:rgba(0,0,0,0.015)}.raci-cell{display:inline-flex;width:28px;height:28px;border-radius:6px;align-items:center;justify-content:center;font-weight:800;font-size:12px}.raci-r{background:var(--coral);color:white}.raci-a{background:var(--navy);color:white}.raci-c{background:var(--yellow);color:white}.raci-i{background:var(--bg-subtle);color:var(--text-secondary)}.raci-legend{display:flex;gap:20px;margin-top:16px;justify-content:center;flex-wrap:wrap}.raci-legend-item{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text-secondary)}
.modules-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-top:4px}.module-card{background:var(--bg-card);border:1px solid rgba(0,0,0,0.06);border-radius:var(--radius-sm);padding:16px;transition:all 0.2s}.module-card:hover{box-shadow:var(--shadow-md);transform:translateY(-1px)}.module-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.module-name{font-weight:600;font-size:13px;color:var(--navy)}.module-project{font-size:11px;color:var(--text-secondary);margin-top:2px}.module-stages{display:flex;gap:4px;margin-top:12px}.module-stage{flex:1;text-align:center}.module-stage-bar{height:4px;border-radius:2px;margin-bottom:4px}.module-stage-bar.done{background:var(--green)}.module-stage-bar.in-progress{background:var(--coral)}.module-stage-bar.pending{background:var(--bg-subtle)}.module-stage-label{font-size:9px;text-transform:uppercase;letter-spacing:0.5px;color:var(--text-light)}
.risk-row{display:grid;grid-template-columns:auto 1fr auto auto auto;gap:16px;align-items:center;padding:14px 0;border-bottom:1px solid var(--bg-subtle)}.risk-row:last-child{border-bottom:none}.risk-severity{width:8px;height:8px;border-radius:2px}.risk-severity.high{background:var(--red)}.risk-severity.medium{background:var(--yellow)}.risk-severity.low{background:var(--green)}.risk-desc{font-size:13px}.risk-project{font-size:11px;color:var(--text-secondary)}.risk-impact{font-size:11px;padding:3px 10px;border-radius:12px;font-weight:600}.risk-impact.high{background:var(--red-bg);color:var(--red)}.risk-impact.medium{background:var(--yellow-bg);color:var(--yellow)}.risk-impact.low{background:var(--green-bg);color:var(--green)}
.budget-bars{display:flex;flex-direction:column;gap:16px}.budget-item label{display:flex;justify-content:space-between;font-size:12px;color:var(--text-secondary);margin-bottom:6px}.budget-item label strong{color:var(--navy)}.budget-track{height:10px;background:var(--bg-subtle);border-radius:5px;overflow:hidden}.budget-fill{height:100%;border-radius:5px;transition:width 1s ease}.budget-fill.ok{background:linear-gradient(90deg,var(--navy),var(--navy-light))}.budget-fill.warn{background:linear-gradient(90deg,var(--yellow),#FBBF24)}
.decision-item{display:flex;gap:12px;padding:12px 0;border-bottom:1px solid var(--bg-subtle)}.decision-item:last-child{border-bottom:none}.decision-icon{width:28px;height:28px;background:var(--coral);border-radius:6px;display:flex;align-items:center;justify-content:center;color:white;font-size:12px;flex-shrink:0;margin-top:2px;font-weight:700}.decision-text{font-size:13px;line-height:1.5}.decision-due{font-size:11px;color:var(--coral);font-weight:600;margin-top:2px}
.progress-section,.bottom-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:36px}.tab-content{display:none}.tab-content.active{display:block;animation:fadeIn 0.3s ease}@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@media(max-width:1200px){.kpi-grid{grid-template-columns:repeat(3,1fr)}.progress-section,.bottom-grid{grid-template-columns:1fr}}@media(max-width:768px){.header,.main{padding:20px 24px}.nav-tabs{padding:12px 24px 0}.kpi-grid{grid-template-columns:repeat(2,1fr)}.header-top{flex-direction:column;gap:16px}}@media print{.nav-tabs,.import-btn{display:none}.card{break-inside:avoid}}
</style>
</head>
<body>
<div class="header">
  <div class="header-top">
    <div class="header-brand">
      <div class="header-logo">P&P</div>
      <div class="header-titles">
        <h1>Programa de Implanta√ß√£o Softexpert</h1>
        <p>Status Report Executivo ‚Äî Plano&Plano Desenvolvimento Imobili√°rio</p>
      </div>
    </div>
    <div class="header-meta">
      <div class="header-meta-item"><label>Atualizado em</label><span id="hDate">‚Äî</span></div>
    </div>
  </div>
</div>
<div class="nav-tabs">
  <button class="nav-tab active" onclick="switchTab(this,'overview')">Vis√£o Geral</button>
  <button class="nav-tab" onclick="switchTab(this,'projects')">Projetos &amp; M√≥dulos</button>
  <button class="nav-tab" onclick="switchTab(this,'risks')">Riscos &amp; Impedimentos</button>
  <button class="nav-tab" onclick="switchTab(this,'people')">Governan√ßa &amp; Pessoas</button>
  <button class="nav-tab" onclick="switchTab(this,'budget')">Investimento</button>
</div>
<div class="main">
  <div class="tab-content active" id="tab-overview">
    <div class="kpi-grid" id="kpiGrid"></div>
    <div class="section-header"><h2>Cronograma dos Projetos</h2><div class="line"></div><div class="count">Clique para expandir etapas</div></div>
    <div class="card" style="margin-bottom:36px"><div class="card-body" style="padding:16px 24px"><div class="gantt-wrapper"><div class="gantt-container" id="ganttChart"></div></div></div></div>
    <div class="bottom-grid">
      <div class="card"><div class="card-header"><h3>üèÜ Conquistas &amp; Quick Wins</h3></div><div class="card-body" id="winsBox"></div></div>
    </div>
  </div>
  <div class="tab-content" id="tab-projects">
    <div class="section-header"><h2>Mapa de M√≥dulos por Projeto</h2><div class="line"></div><div class="count" id="modCount">12 m√≥dulos</div></div>
    <div class="modules-grid" id="modulesGrid" style="margin-bottom:36px"></div>
  </div>
  <div class="tab-content" id="tab-risks">
    <div class="section-header"><h2>Riscos Ativos</h2><div class="line"></div><div class="count" id="riskCount">5 riscos</div></div>
    <div class="card" style="margin-bottom:24px"><div class="card-body" id="risksBox"></div></div>
    <div class="section-header"><h2>Impedimentos</h2><div class="line"></div><div class="count" id="impCount">3 impedimentos</div></div>
    <div class="card"><div class="card-body" id="impBox"></div></div>
    <div class="section-header" style="margin-top:36px"><h2>Decis√µes e Itens Pendentes</h2><div class="line"></div></div>
    <div class="card"><div class="card-body" id="decisionsBox"></div></div>
  </div>
  <div class="tab-content" id="tab-people">
    <div class="section-header"><h2>Organograma do Programa</h2><div class="line"></div></div>
    <div class="card" style="margin-bottom:24px"><div class="card-body" style="padding:32px 24px"><div class="org-chart" id="orgChart"></div></div></div>
    <div class="section-header"><h2>Matriz RACI</h2><div class="line"></div></div>
    <div class="card" style="margin-bottom:24px"><div class="card-body" style="padding:16px 24px"><div class="raci-wrapper" id="raciMatrix"></div></div></div>
    <div class="section-header"><h2>Capacita√ß√£o &amp; Treinamentos</h2><div class="line"></div></div>
    <div class="card"><div class="card-body" id="trainingBox"></div></div>
  </div>
  <div class="tab-content" id="tab-budget">
    <div class="section-header"><h2>Investimento do Programa</h2><div class="line"></div></div>
    <div class="kpi-grid" id="budgetKpis" style="grid-template-columns:repeat(4,1fr);margin-bottom:24px"></div>
    <div class="progress-section">
      <div class="card"><div class="card-header"><h3>Distribui√ß√£o por Categoria</h3></div><div class="card-body" id="budgetCatBox"></div></div>
      <div class="card"><div class="card-header"><h3>Evolu√ß√£o Mensal (Realizado vs. Planejado)</h3></div><div class="card-body" id="budgetChart"></div></div>
    </div>
  </div>
</div>
<script>
function switchTab(b,t){document.querySelectorAll('.tab-content').forEach(e=>e.classList.remove('active'));document.querySelectorAll('.nav-tab').forEach(e=>e.classList.remove('active'));document.getElementById('tab-'+t).classList.add('active');b.classList.add('active')}

const ML=['Jul/25','Ago/25','Set/25','Out/25','Nov/25','Dez/25','Jan/26','Fev/26','Mar/26','Abr/26','Mai/26','Jun/26','Jul/26','Ago/26','Set/26','Out/26','Nov/26','Dez/26'];
const MK=['2025-07','2025-08','2025-09','2025-10','2025-11','2025-12','2026-01','2026-02','2026-03','2026-04','2026-05','2026-06','2026-07','2026-08','2026-09','2026-10','2026-11','2026-12'];
const mNm={jan:'01',fev:'02',mar:'03',abr:'04',mai:'05',jun:'06',jul:'07',ago:'08',set:'09',out:'10',nov:'11',dez:'12'};
const avC=['#E8584F','#1B2A4A','#2A3F6B','#7C3AED','#0891B2','#059669','#D97706','#DC2626','#4F46E5','#B45309'];let cI=0;
function nxC(){return avC[(cI++)%avC.length]}
function todayMI(){const d=new Date(),k=d.getFullYear()+'-'+String(d.getMonth()+1).padStart(2,'0');const i=MK.indexOf(k);return i>=0?i:7}
function V(x){return x==null?'':String(x).trim()}
function N(x){let n=parseFloat(V(x).replace(/[^0-9.\-]/g,''));return isNaN(n)?0:n}
function P(x){let n=parseFloat(V(x).replace('%',''));return isNaN(n)?0:n}
function fK(n){return n>=1e6?'R$ '+(n/1e6).toFixed(1)+'M':n>=1e3?'R$ '+(n/1e3).toFixed(0)+'K':'R$ '+n}
function ini(n){return n.split(' ').map(w=>w[0]).filter(Boolean).slice(0,2).join('').toUpperCase()}
function pM(s){s=V(s);let m;m=s.match(/(\d{4})-(\d{2})/);if(m)return m[1]+'-'+m[2];m=s.match(/([a-zA-Z]{3})\/(\d{4})/i);if(m)return m[2]+'-'+(mNm[m[1].toLowerCase()]||'01');m=s.match(/([a-zA-Z]{3})\/(\d{2})/i);if(m)return'20'+m[2]+'-'+(mNm[m[1].toLowerCase()]||'01');m=s.match(/(\d{2})\/(\d{4})/);if(m)return m[2]+'-'+m[1];return''}
function sC(s){s=V(s).toLowerCase();if(s.includes('conclu')||s.includes('complet'))return'completed';if(s.includes('prazo')||s.includes('andamento'))return'on-track';if(s.includes('aten'))return'attention';if(s.includes('cr√≠t')||s.includes('crit')||s.includes('bloq'))return'critical';return'not-started'}
function sN(c){return{completed:'Conclu√≠do','on-track':'No Prazo',attention:'Aten√ß√£o',critical:'Cr√≠tico','not-started':'N√£o Iniciado'}[c]||c}
function bC(c){return{completed:'completed-bar','on-track':'on-track-bar',attention:'attention-bar'}[c]||'not-started-bar'}
function svC(s){s=V(s).toLowerCase();return s.includes('alt')||s.includes('cr√≠t')||s.includes('crit')?'high':s.includes('m√©d')||s.includes('med')?'medium':'low'}
function toast(msg,ok){const t=document.createElement('div');t.className='toast';t.style.background=ok?'var(--green)':'var(--red)';t.textContent=msg;document.body.appendChild(t);setTimeout(()=>t.remove(),3500)}

// === ENDERE√áO PLANILHA ===
// Altere o caminho abaixo para o local da sua planilha relativa ao HTML
const PLANILHA_PATH = 'https://github.com/Lucas7Fernandes/Softexpert/blob/main/template-softexpert.xlsx'; // ENDERE√áO PLANILHA

function carregarPlanilha(){
  fetch(PLANILHA_PATH).then(r=>{if(!r.ok)throw new Error('Arquivo n√£o encontrado: '+PLANILHA_PATH);return r.arrayBuffer()}).then(buf=>{
    const wb=XLSX.read(buf,{type:'array'});const S={};wb.SheetNames.forEach(n=>{S[n]=XLSX.utils.sheet_to_json(wb.Sheets[n],{defval:''})});loadData(S);
    toast('‚úì Planilha carregada ('+wb.SheetNames.length+' abas)',true);
  }).catch(err=>{console.warn('Planilha n√£o encontrada, usando dados padr√£o.',err.message);loadDefaultData()})
}

let D={programa:{},projetos:[],etapas:[],modulos:[],riscos:[],organograma:[],raci:[],capacitacao:[],budgetCat:[],budgetMonthly:[],decisoes:[]};

function loadData(S){
  const prog=S['Programa']||[];D.programa={};prog.forEach(r=>{const k=V(r['Campo']||r[Object.keys(r)[0]]);const v2=V(r['Valor']||r[Object.keys(r)[1]]);if(k&&k!=='Campo')D.programa[k]=v2});
  D.projetos=(S['Projetos']||[]).filter(r=>V(r['ID']||'').match(/^P\d/i));
  D.etapas=(S['Etapas']||[]).filter(r=>V(r['ID Projeto']||'').match(/^P\d/i));
  D.modulos=(S['M√≥dulos']||S['Modulos']||[]).filter(r=>V(r['M√≥dulo']||r['Modulo']||'').length>3&&!V(r['ID Projeto']||'').toLowerCase().includes('ref'));
  D.riscos=(S['Riscos']||[]).filter(r=>V(r['ID']||'').match(/^[RI]\d/i));
  D.organograma=(S['Organograma']||[]).filter(r=>V(r['Nome']||'').length>2&&!V(r['N√≠vel']||r['Nivel']||'').toLowerCase().includes('sponsor /'));
  D.raci=(S['RACI']||[]).filter(r=>V(r['Atividade']||'').length>3&&!V(r['Atividade']||'').toLowerCase().includes('nome da'));
  D.capacitacao=(S['Capacita√ß√£o']||S['Capacitacao']||[]).filter(r=>V(r['Indicador']||'').length>3);
  const bR=S['Budget']||[];D.budgetCat=bR.filter(r=>{const c=V(r['Categoria']||'');return c.length>3&&!c.includes('TOTAL')&&!c.includes('Evolu√ß√£o')&&!c.match(/\//)});
  D.budgetMonthly=bR.filter(r=>V(r['M√™s']||r['Mes']||'').match(/\//));if(!D.budgetMonthly.length)D.budgetMonthly=bR.filter(r=>V(r['Categoria']||'').match(/^[A-Z][a-z]{2}\//));
  D.decisoes=(S['Decis√µes']||S['Decisoes']||[]).filter(r=>V(r['Tipo']||'').length>3&&!V(r['Tipo']||'').toLowerCase().includes('decis√£o /'));
  renderAll()}

function renderAll(){renderHeader();renderKPIs();renderGantt();renderDecisions();renderModules();renderRisks();renderOrg();renderRaci();renderTraining();renderBudget()}

function renderHeader(){const p=D.programa;if(p['Data de Atualiza√ß√£o'])document.getElementById('hDate').textContent=p['Data de Atualiza√ß√£o']}

function renderKPIs(){const pr=D.projetos,mo=D.modulos,ri=D.riscos.filter(r=>V(r['Tipo']).toLowerCase().includes('risco')),im=D.riscos.filter(r=>V(r['Tipo']).toLowerCase().includes('imped'));const tp=pr.length,cp=pr.filter(r=>sC(V(r['Status']))=='completed').length,ns=pr.filter(r=>sC(V(r['Status']))=='not-started').length,avg=tp?Math.round(pr.reduce((s,r)=>s+P(r['% Avan√ßo']||r['% Avanco']||'0'),0)/tp):0,hr=ri.filter(r=>svC(V(r['Severidade']))=='high').length;
document.getElementById('kpiGrid').innerHTML=`<div class="kpi-card accent-navy"><div class="kpi-label">Projetos</div><div class="kpi-value">${tp}</div><div class="kpi-sub">${tp-cp-ns} em andamento ¬∑ ${cp} conclu√≠do ¬∑ ${ns} n√£o iniciado</div></div><div class="kpi-card accent-coral"><div class="kpi-label">M√≥dulos</div><div class="kpi-value">${mo.length}</div><div class="kpi-sub">${mo.filter(m=>V(m['Status Geral']).toLowerCase().includes('go-live')).length} go-live ¬∑ ${mo.filter(m=>V(m['Status Geral']).toLowerCase().includes('homol')).length} homol. ¬∑ ${mo.filter(m=>V(m['Status Geral']).toLowerCase().includes('config')).length} config.</div></div><div class="kpi-card accent-green"><div class="kpi-label">Avan√ßo Geral</div><div class="kpi-value">${avg}%</div><div class="kpi-sub">M√©dia dos projetos</div></div><div class="kpi-card accent-yellow"><div class="kpi-label">Riscos Ativos</div><div class="kpi-value">${ri.length}</div><div class="kpi-sub">${hr} alto(s) ¬∑ ${ri.length-hr} m√©dio/baixo</div></div><div class="kpi-card accent-red"><div class="kpi-label">Impedimentos</div><div class="kpi-value">${im.length}</div><div class="kpi-sub">${im.filter(r=>svC(V(r['Impacto']||r['Severidade']))=='high').length} cr√≠tico(s)</div></div>`}

function renderGantt(){const pr=D.projetos,et=D.etapas,tI=todayMI(),tP=((tI+.5)/18*100).toFixed(2);let h='<div class="gantt-header"><div class="gantt-header-label">Projeto / Etapa</div><div class="gantt-months">';ML.forEach((m,i)=>h+=`<div class="gantt-month" style="${i===tI?'color:var(--coral);font-weight:700':''}">${m}</div>`);h+='</div></div><div style="position:relative"><div class="gantt-today-global" style="left:calc(260px + (100% - 260px) * '+tP+' / 100)"></div>';
pr.forEach((p,pi)=>{const id=V(p['ID']||'p'+pi),nm=V(p['Projeto']),ar=V(p['√Årea']||p['Area']||''),st=sC(V(p['Status'])),pg=P(p['% Avan√ßo']||p['% Avanco']||'0'),sk=pM(V(p['In√≠cio Planejado']||p['Inicio Planejado']||'')),ek=pM(V(p['Fim Planejado']||p['Previs√£o Entrega']||p['Previsao Entrega']||''));const si=MK.indexOf(sk),ei=MK.indexOf(ek),bL=si>=0?(si/18*100).toFixed(2)+'%':'0%',bW=(si>=0&&ei>=0)?((ei-si+1)/18*100).toFixed(2)+'%':'0%';
h+=`<div class="gantt-row project-row" onclick="togglePhases('${id}')"><div class="gantt-row-label"><div class="gantt-expand-btn" id="btn-${id}">+</div><div class="gantt-row-info"><div class="gantt-row-name">${nm}</div><div class="gantt-row-area">${ar}</div></div><div class="gantt-row-status"><span class="status-pill ${st}" style="font-size:10px">${sN(st)}</span></div></div><div class="gantt-bars">`;for(let i=0;i<18;i++)h+=`<div class="gantt-grid-line" style="left:${(i/18*100).toFixed(2)}%"></div>`;h+=`<div class="gantt-bar ${bC(st)}" style="left:${bL};width:${bW}">${pg}%</div></div></div>`;
const pe=et.filter(e=>V(e['ID Projeto'])===id||V(e['Projeto'])===nm);h+=`<div class="gantt-phases-container" id="phases-${id}">`;pe.forEach(e=>{const en=V(e['Etapa']),es=sC(V(e['Status'])),esk=pM(V(e['In√≠cio']||e['Inicio']||'')),eek=pM(V(e['Fim']||''));const esi=MK.indexOf(esk),eei=MK.indexOf(eek),eL=esi>=0?(esi/18*100).toFixed(2)+'%':'0%',eW=(esi>=0&&eei>=0)?((eei-esi+1)/18*100).toFixed(2)+'%':'0%';h+=`<div class="gantt-row phase-row"><div class="gantt-row-label"><div class="gantt-row-info"><div class="gantt-row-name">${en}</div></div></div><div class="gantt-bars">`;for(let i=0;i<18;i++)h+=`<div class="gantt-grid-line" style="left:${(i/18*100).toFixed(2)}%"></div>`;h+=`<div class="gantt-bar phase-bar ${bC(es)}" style="left:${eL};width:${eW}" title="${en}">${en}</div></div></div>`});h+='</div>'});h+='</div>';document.getElementById('ganttChart').innerHTML=h}
function togglePhases(id){const c=document.getElementById('phases-'+id),b=document.getElementById('btn-'+id);if(!c||!b)return;const o=c.classList.contains('open');c.classList.toggle('open');b.classList.toggle('expanded');b.textContent=o?'+':'‚àí'}

function renderDecisions(){const dc=D.decisoes.filter(r=>V(r['Tipo']).toLowerCase().includes('decis')),wn=D.decisoes.filter(r=>V(r['Tipo']).toLowerCase().includes('conquis'));document.getElementById('decisionsBox').innerHTML=dc.map((d,i)=>`<div class="decision-item"><div class="decision-icon">${i+1}</div><div><div class="decision-text">${V(d['Descri√ß√£o']||d['Descricao']||'')}</div><div class="decision-due">Prazo: ${V(d['Prazo / Data']||d['Prazo']||'')}</div></div></div>`).join('')||'<p style="color:var(--text-light)">Sem decis√µes</p>';document.getElementById('winsBox').innerHTML=wn.map(w=>`<div class="decision-item"><div class="decision-icon" style="background:var(--green)">‚úì</div><div><div class="decision-text">${V(w['Descri√ß√£o']||w['Descricao']||'')}</div></div></div>`).join('')||'<p style="color:var(--text-light)">Sem conquistas</p>'}

function renderModules(){const mo=D.modulos;document.getElementById('modCount').textContent=mo.length+' m√≥dulos';const sc=x=>{x=V(x).toLowerCase();return x.includes('conclu')?'done':x.includes('andamento')?'in-progress':'pending'};const mp=x=>{x=V(x).toLowerCase();return x.includes('go-live')?'completed':x.includes('homol')?'on-track':x.includes('config')?'attention':'not-started'};document.getElementById('modulesGrid').innerHTML=mo.map(m=>`<div class="module-card"><div class="module-top"><div><div class="module-name">${V(m['M√≥dulo']||m['Modulo']||'')}</div><div class="module-project">${V(m['Projeto']||'')}</div></div><span class="status-pill ${mp(V(m['Status Geral']||''))}">${V(m['Status Geral'])||'Pendente'}</span></div><div class="module-stages"><div class="module-stage"><div class="module-stage-bar ${sc(m['Config.']||m['Config']||'')}"></div><div class="module-stage-label">Config</div></div><div class="module-stage"><div class="module-stage-bar ${sc(m['Homologa√ß√£o']||m['Homologacao']||'')}"></div><div class="module-stage-label">Homol</div></div><div class="module-stage"><div class="module-stage-bar ${sc(m['Go-Live']||'')}"></div><div class="module-stage-label">Go-Live</div></div></div></div>`).join('')}

function renderRisks(){const ri=D.riscos.filter(r=>V(r['Tipo']).toLowerCase().includes('risco')),im=D.riscos.filter(r=>V(r['Tipo']).toLowerCase().includes('imped'));document.getElementById('riskCount').textContent=ri.length+' riscos';document.getElementById('impCount').textContent=im.length+' impedimentos';const rH=items=>items.map(r=>{const sv=svC(V(r['Severidade'])),ip=svC(V(r['Impacto'])),st=V(r['Status']||''),stc=st.toLowerCase().includes('bloq')?'critical':st.toLowerCase().includes('aberto')?'attention':'on-track';return`<div class="risk-row"><div class="risk-severity ${sv}"></div><div><div class="risk-desc"><strong>${V(r['Descri√ß√£o']||r['Descricao']||'')}</strong></div><div class="risk-project">${V(r['Projeto Relacionado']||'')} ¬∑ ${V(r['A√ß√£o de Mitiga√ß√£o']||r['Acao de Mitigacao']||'')}</div></div><div class="risk-impact ${ip}">${V(r['Impacto']||'')}</div><div style="font-size:12px;color:var(--text-secondary)">${V(r['Categoria']||'')}</div><span class="status-pill ${stc}" style="font-size:10px">${st}</span></div>`}).join('');document.getElementById('risksBox').innerHTML=rH(ri)||'<p style="color:var(--text-light)">Nenhum risco</p>';document.getElementById('impBox').innerHTML=rH(im)||'<p style="color:var(--text-light)">Nenhum impedimento</p>'}

function renderOrg(){cI=0;const org=D.organograma,lv=k=>org.filter(r=>V(r['N√≠vel']||r['Nivel']||'').toLowerCase().includes(k)),pH=p=>`<div class="org-person"><div class="org-avatar" style="background:${nxC()}">${ini(V(p['Nome']))}</div><div class="org-person-info"><div class="org-person-name">${V(p['Nome'])}</div><div class="org-person-title">${V(p['Cargo / T√≠tulo']||p['Cargo / Titulo']||p['Papel']||'')}</div></div></div>`,cH=(role,cls,ppl,xs)=>{if(!ppl.length)return'';return`<div class="org-card ${cls}" style="${xs||''}"><div class="org-role">${role}</div><div class="org-people-list">${ppl.map(pH).join('')}</div></div>`};const team=lv('time'),byA={};team.forEach(p=>{const a=V(p['√Årea']||p['Area']||'Geral');if(!byA[a])byA[a]=[];byA[a].push(p)});const tH=Object.entries(byA).map(([a,ms])=>`<div class="org-area-card"><div class="org-area-label">${a}</div><div class="org-area-members">${ms.map(m=>`<div class="org-area-member"><div class="org-area-member-dot" style="background:${nxC()}"></div><div><div class="org-area-member-name">${V(m['Nome'])}</div><div class="org-area-member-role">${V(m['Papel']||'')}</div></div></div>`).join('')}</div></div>`).join('');const gestao=org.filter(r=>{const n=V(r['N√≠vel']||r['Nivel']||'').toLowerCase();return n.includes('gest√£o')||n.includes('gestao')}),arq=org.filter(r=>{const n=V(r['N√≠vel']||r['Nivel']||'').toLowerCase();return n.includes('l√≠der')||n.includes('lider')||n.includes('arq')}),dec=org.filter(r=>{const n=V(r['N√≠vel']||r['Nivel']||'').toLowerCase();return n.includes('decisor')||n.includes('go-nogo')});document.getElementById('orgChart').innerHTML=cH('Sponsor','sponsor',lv('sponsor'))+(lv('sponsor').length?'<div class="org-connector-v"></div>':'')+cH('Comit√™ Executivo','comite',lv('comit'),'min-width:300px;max-width:360px')+(lv('comit').length?'<div class="org-connector-v"></div>':'')+`<div class="org-level" style="gap:24px;flex-wrap:wrap;justify-content:center">${cH('Gest√£o do Programa','gestao',gestao)}${cH('L√≠der Arquitetura / Infra','gestao',arq)}${cH('Decisores Go-NoGo','decisor',dec)}</div>`+(Object.keys(byA).length?`<div class="org-connector-v"></div><div class="org-team-box"><div class="org-team-title">Time do Projeto ‚Äî Key Users por √Årea de Neg√≥cio</div><div class="org-area-grid">${tH}</div></div>`:'')}

function renderRaci(){const rows=D.raci;if(!rows.length)return;const cols=Object.keys(rows[0]).filter(k=>k!=='Atividade'&&!k.startsWith('__'));let h='<table class="raci-table"><thead><tr><th>Atividade</th>';cols.forEach(c=>h+=`<th>${c}</th>`);h+='</tr></thead><tbody>';rows.forEach(r=>{h+=`<tr><td>${V(r['Atividade'])}</td>`;cols.forEach(c=>{const x=V(r[c]).toUpperCase();const cl=x==='R'?'raci-r':x==='A'?'raci-a':x==='C'?'raci-c':x==='I'?'raci-i':'';h+=`<td>${cl?`<span class="raci-cell ${cl}">${x}</span>`:''}</td>`});h+='</tr>'});h+='</tbody></table><div class="raci-legend"><div class="raci-legend-item"><span class="raci-cell raci-r" style="width:22px;height:22px;font-size:10px">R</span> Respons√°vel</div><div class="raci-legend-item"><span class="raci-cell raci-a" style="width:22px;height:22px;font-size:10px">A</span> Aprovador</div><div class="raci-legend-item"><span class="raci-cell raci-c" style="width:22px;height:22px;font-size:10px">C</span> Consultado</div><div class="raci-legend-item"><span class="raci-cell raci-i" style="width:22px;height:22px;font-size:10px">I</span> Informado</div></div>';document.getElementById('raciMatrix').innerHTML=h}

function renderTraining(){document.getElementById('trainingBox').innerHTML='<div class="budget-bars">'+D.capacitacao.map(r=>{const lb=V(r['Indicador']),rl=N(r['Realizado']),mt=N(r['Meta']),pc=mt>0?Math.round(rl/mt*100):0;return`<div class="budget-item"><label><span>${lb}</span><strong>${rl} de ${mt}</strong></label><div class="budget-track"><div class="budget-fill ok" style="width:${pc}%"></div></div></div>`}).join('')+'</div>'}

function renderBudget(){const p=D.programa,tot=N(p['Or√ßamento Total (R$)']||p['Orcamento Total (R$)']||0),rea=N(p['Realizado (R$)']||0),com=N(p['Comprometido (R$)']||0),sal=N(p['Saldo Dispon√≠vel (R$)']||p['Saldo Disponivel (R$)']||0),pU=tot>0?Math.round(rea/tot*100):0,pS=tot>0?Math.round(sal/tot*100):0;
document.getElementById('budgetKpis').innerHTML=`<div class="kpi-card accent-navy"><div class="kpi-label">Or√ßamento Total</div><div class="kpi-value" style="font-size:26px">${fK(tot)}</div></div><div class="kpi-card accent-green"><div class="kpi-label">Realizado</div><div class="kpi-value" style="font-size:26px">${fK(rea)}</div><div class="kpi-sub">${pU}% do or√ßamento</div></div><div class="kpi-card accent-yellow"><div class="kpi-label">Comprometido</div><div class="kpi-value" style="font-size:26px">${fK(com)}</div></div><div class="kpi-card accent-coral"><div class="kpi-label">Saldo Dispon√≠vel</div><div class="kpi-value" style="font-size:26px">${fK(sal)}</div><div class="kpi-sub">${pS}%${pS<20?' ‚Äî <span class="down">Aten√ß√£o</span>':''}</div></div>`;
document.getElementById('budgetCatBox').innerHTML='<div class="budget-bars">'+D.budgetCat.map(r=>{const lb=V(r['Categoria']),or=N(r['Or√ßado (R$)']||r['Orcado (R$)']||0),re=N(r['Realizado (R$)']||0),pc=or>0?Math.round(re/or*100):0;return`<div class="budget-item"><label><span>${lb}</span><strong>${fK(re)} / ${fK(or)}</strong></label><div class="budget-track"><div class="budget-fill ${pc>85?'warn':'ok'}" style="width:${pc}%"></div></div></div>`}).join('')+'</div>';
const mo=D.budgetMonthly;if(!mo.length)return;const mx=Math.max(...mo.map(m=>Math.max(N(m['Realizado (R$)']||0),N(m['Planejado (R$)']||m['Or√ßado (R$)']||m['Orcado (R$)']||0))),1);let mH='<div style="display:flex;flex-direction:column;gap:8px">';
mo.forEach((m,i)=>{const mn=V(m['M√™s']||m['Mes']||m['Categoria']||''),r=N(m['Realizado (R$)']||0),p=N(m['Planejado (R$)']||m['Or√ßado (R$)']||m['Orcado (R$)']||0);mH+=`<div style="display:grid;grid-template-columns:60px 1fr 60px;align-items:center;gap:8px;font-size:12px"><span style="color:var(--text-secondary)">${mn}</span><div style="display:flex;gap:2px;align-items:center"><div style="height:16px;background:${i===mo.length-1?'var(--coral)':'var(--navy)'};border-radius:3px;width:${(r/mx*100).toFixed(0)}%"></div><div style="height:10px;background:rgba(27,42,74,0.2);border-radius:3px;width:${(p/mx*100).toFixed(0)}%"></div></div><span style="font-weight:600;text-align:right">${fK(r)}</span></div>`});
mH+='</div><div style="display:flex;gap:16px;margin-top:16px;font-size:11px;color:var(--text-secondary)"><span style="display:flex;align-items:center;gap:4px"><span style="width:12px;height:12px;background:var(--navy);border-radius:2px;display:inline-block"></span> Realizado</span><span style="display:flex;align-items:center;gap:4px"><span style="width:12px;height:12px;background:rgba(27,42,74,0.2);border-radius:2px;display:inline-block"></span> Planejado</span></div>';document.getElementById('budgetChart').innerHTML=mH}


function loadDefaultData(){ loadData({
    'Programa':[{Campo:'Nome do Programa',Valor:'Programa de Implanta√ß√£o Softexpert'},{Campo:'Data de Atualiza√ß√£o',Valor:'10 Fev 2026'},{Campo:'Fase Atual',Valor:'Implanta√ß√£o'},{Campo:'Status Geral',Valor:'Em andamento'},{Campo:'Or√ßamento Total (R$)',Valor:'1200000'},{Campo:'Realizado (R$)',Valor:'620000'},{Campo:'Comprometido (R$)',Valor:'380000'},{Campo:'Saldo Dispon√≠vel (R$)',Valor:'200000'}],
    'Projetos':[{ID:'P01',Projeto:'Gest√£o de Documentos','√Årea':'Qualidade & Compliance',Status:'Conclu√≠do','% Avan√ßo':'100%','In√≠cio Planejado':'Jul/2025','Fim Planejado':'Dez/2025'},{ID:'P02',Projeto:'Gest√£o de N√£o Conformidades','√Årea':'Qualidade',Status:'No Prazo','% Avan√ßo':'72%','In√≠cio Planejado':'Set/2025','Fim Planejado':'Abr/2026'},{ID:'P03',Projeto:'Gest√£o de Processos (BPM)','√Årea':'Processos & TI',Status:'No Prazo','% Avan√ßo':'65%','In√≠cio Planejado':'Set/2025','Fim Planejado':'Mai/2026'},{ID:'P04',Projeto:'Gest√£o de Riscos','√Årea':'Compliance & Jur√≠dico',Status:'Aten√ß√£o','% Avan√ßo':'48%','In√≠cio Planejado':'Nov/2025','Fim Planejado':'Jun/2026'},{ID:'P05',Projeto:'Gest√£o de Auditorias','√Årea':'Auditoria Interna',Status:'No Prazo','% Avan√ßo':'55%','In√≠cio Planejado':'Out/2025','Fim Planejado':'Jul/2026'},{ID:'P06',Projeto:'Gest√£o de Indicadores (KPIs)','√Årea':'Planejamento Estrat√©gico',Status:'Aten√ß√£o','% Avan√ßo':'35%','In√≠cio Planejado':'Dez/2025','Fim Planejado':'Ago/2026'},{ID:'P07',Projeto:'Gest√£o de Fornecedores','√Årea':'Suprimentos',Status:'N√£o Iniciado','% Avan√ßo':'0%','In√≠cio Planejado':'Abr/2026','Fim Planejado':'Out/2026'}],
    'Etapas':[{'ID Projeto':'P01',Etapa:'Levantamento de requisitos','In√≠cio':'Jul/2025',Fim:'Jul/2025',Status:'Conclu√≠do'},{'ID Projeto':'P01',Etapa:'Configura√ß√£o dos m√≥dulos','In√≠cio':'Ago/2025',Fim:'Set/2025',Status:'Conclu√≠do'},{'ID Projeto':'P01',Etapa:'Homologa√ß√£o e testes','In√≠cio':'Set/2025',Fim:'Out/2025',Status:'Conclu√≠do'},{'ID Projeto':'P01',Etapa:'Migra√ß√£o de dados','In√≠cio':'Out/2025',Fim:'Nov/2025',Status:'Conclu√≠do'},{'ID Projeto':'P01',Etapa:'Go-Live e estabiliza√ß√£o','In√≠cio':'Nov/2025',Fim:'Dez/2025',Status:'Conclu√≠do'},{'ID Projeto':'P02',Etapa:'Levantamento de requisitos','In√≠cio':'Set/2025',Fim:'Set/2025',Status:'Conclu√≠do'},{'ID Projeto':'P02',Etapa:'Configura√ß√£o dos m√≥dulos','In√≠cio':'Out/2025',Fim:'Dez/2025',Status:'Conclu√≠do'},{'ID Projeto':'P02',Etapa:'Homologa√ß√£o e testes','In√≠cio':'Jan/2026',Fim:'Fev/2026',Status:'Em andamento'},{'ID Projeto':'P02',Etapa:'Treinamento de usu√°rios','In√≠cio':'Fev/2026',Fim:'Mar/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P02',Etapa:'Go-Live e estabiliza√ß√£o','In√≠cio':'Mar/2026',Fim:'Abr/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P03',Etapa:'Levantamento de requisitos','In√≠cio':'Set/2025',Fim:'Out/2025',Status:'Conclu√≠do'},{'ID Projeto':'P03',Etapa:'Modelagem de processos AS-IS','In√≠cio':'Out/2025',Fim:'Nov/2025',Status:'Conclu√≠do'},{'ID Projeto':'P03',Etapa:'Configura√ß√£o e automa√ß√£o','In√≠cio':'Dez/2025',Fim:'Fev/2026',Status:'Em andamento'},{'ID Projeto':'P03',Etapa:'Homologa√ß√£o e testes','In√≠cio':'Fev/2026',Fim:'Mar/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P03',Etapa:'Go-Live e estabiliza√ß√£o','In√≠cio':'Abr/2026',Fim:'Mai/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P04',Etapa:'Levantamento de requisitos','In√≠cio':'Nov/2025',Fim:'Dez/2025',Status:'Conclu√≠do'},{'ID Projeto':'P04',Etapa:'Config. da matriz de riscos','In√≠cio':'Jan/2026',Fim:'Fev/2026',Status:'Aten√ß√£o'},{'ID Projeto':'P04',Etapa:'Homologa√ß√£o e testes','In√≠cio':'Mar/2026',Fim:'Abr/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P04',Etapa:'Treinamento de usu√°rios','In√≠cio':'Abr/2026',Fim:'Mai/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P04',Etapa:'Go-Live e estabiliza√ß√£o','In√≠cio':'Mai/2026',Fim:'Jun/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P05',Etapa:'Levantamento de requisitos','In√≠cio':'Out/2025',Fim:'Nov/2025',Status:'Conclu√≠do'},{'ID Projeto':'P05',Etapa:'Configura√ß√£o dos m√≥dulos','In√≠cio':'Dez/2025',Fim:'Fev/2026',Status:'Em andamento'},{'ID Projeto':'P05',Etapa:'Homologa√ß√£o e testes','In√≠cio':'Mar/2026',Fim:'Abr/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P05',Etapa:'Treinamento de usu√°rios','In√≠cio':'Mai/2026',Fim:'Mai/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P05',Etapa:'Go-Live e estabiliza√ß√£o','In√≠cio':'Jun/2026',Fim:'Jul/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P06',Etapa:'Levantamento de requisitos','In√≠cio':'Dez/2025',Fim:'Jan/2026',Status:'Conclu√≠do'},{'ID Projeto':'P06',Etapa:'Defini√ß√£o de framework','In√≠cio':'Jan/2026',Fim:'Fev/2026',Status:'Aten√ß√£o'},{'ID Projeto':'P06',Etapa:'Configura√ß√£o do painel','In√≠cio':'Mar/2026',Fim:'Mai/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P06',Etapa:'Homologa√ß√£o e testes','In√≠cio':'Mai/2026',Fim:'Jun/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P06',Etapa:'Go-Live e estabiliza√ß√£o','In√≠cio':'Jul/2026',Fim:'Ago/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P07',Etapa:'Levantamento de requisitos','In√≠cio':'Abr/2026',Fim:'Mai/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P07',Etapa:'Configura√ß√£o dos m√≥dulos','In√≠cio':'Mai/2026',Fim:'Jul/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P07',Etapa:'Homologa√ß√£o e testes','In√≠cio':'Jul/2026',Fim:'Ago/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P07',Etapa:'Treinamento de usu√°rios','In√≠cio':'Ago/2026',Fim:'Set/2026',Status:'N√£o Iniciado'},{'ID Projeto':'P07',Etapa:'Go-Live e estabiliza√ß√£o','In√≠cio':'Set/2026',Fim:'Out/2026',Status:'N√£o Iniciado'}],
    'M√≥dulos':[{'ID Projeto':'P01',Projeto:'Gest√£o de Documentos','M√≥dulo':'Controle de Documentos','Status Geral':'Go-Live','Config.':'Conclu√≠do','Homologa√ß√£o':'Conclu√≠do','Go-Live':'Conclu√≠do'},{'ID Projeto':'P01',Projeto:'Gest√£o de Documentos','M√≥dulo':'Distribui√ß√£o Eletr√¥nica','Status Geral':'Go-Live','Config.':'Conclu√≠do','Homologa√ß√£o':'Conclu√≠do','Go-Live':'Conclu√≠do'},{'ID Projeto':'P02',Projeto:'N√£o Conformidades','M√≥dulo':'Registro de NC','Status Geral':'Homologa√ß√£o','Config.':'Conclu√≠do','Homologa√ß√£o':'Em andamento','Go-Live':'Pendente'},{'ID Projeto':'P02',Projeto:'N√£o Conformidades','M√≥dulo':'A√ß√µes Corretivas (CAPA)','Status Geral':'Homologa√ß√£o','Config.':'Conclu√≠do','Homologa√ß√£o':'Em andamento','Go-Live':'Pendente'},{'ID Projeto':'P03',Projeto:'Processos (BPM)','M√≥dulo':'Modelagem de Processos','Status Geral':'Homologa√ß√£o','Config.':'Conclu√≠do','Homologa√ß√£o':'Em andamento','Go-Live':'Pendente'},{'ID Projeto':'P03',Projeto:'Processos (BPM)','M√≥dulo':'Automa√ß√£o de Workflows','Status Geral':'Configura√ß√£o','Config.':'Em andamento','Homologa√ß√£o':'Pendente','Go-Live':'Pendente'},{'ID Projeto':'P04',Projeto:'Riscos','M√≥dulo':'Matriz de Riscos','Status Geral':'Configura√ß√£o','Config.':'Em andamento','Homologa√ß√£o':'Pendente','Go-Live':'Pendente'},{'ID Projeto':'P04',Projeto:'Riscos','M√≥dulo':'Plano de Tratamento','Status Geral':'Backlog','Config.':'Pendente','Homologa√ß√£o':'Pendente','Go-Live':'Pendente'},{'ID Projeto':'P05',Projeto:'Auditorias','M√≥dulo':'Planejamento de Auditorias','Status Geral':'Homologa√ß√£o','Config.':'Conclu√≠do','Homologa√ß√£o':'Em andamento','Go-Live':'Pendente'},{'ID Projeto':'P05',Projeto:'Auditorias','M√≥dulo':'Execu√ß√£o & Findings','Status Geral':'Configura√ß√£o','Config.':'Em andamento','Homologa√ß√£o':'Pendente','Go-Live':'Pendente'},{'ID Projeto':'P06',Projeto:'Indicadores','M√≥dulo':'Painel de Indicadores','Status Geral':'Configura√ß√£o','Config.':'Em andamento','Homologa√ß√£o':'Pendente','Go-Live':'Pendente'},{'ID Projeto':'P07',Projeto:'Fornecedores','M√≥dulo':'Avalia√ß√£o de Fornecedores','Status Geral':'N√£o Iniciado','Config.':'Pendente','Homologa√ß√£o':'Pendente','Go-Live':'Pendente'}],
    'Riscos':[{ID:'R01',Tipo:'Risco','Descri√ß√£o':'Atraso na aloca√ß√£o de key users de Riscos','Projeto Relacionado':'Gest√£o de Riscos',Severidade:'Alto',Impacto:'Alto',Categoria:'Cronograma','A√ß√£o de Mitiga√ß√£o':'Solicitar refor√ßo via Presid√™ncia',Status:'Aberto'},{ID:'R02',Tipo:'Risco','Descri√ß√£o':'Integra√ß√£o com ERP legado (SAP) com escopo indefinido','Projeto Relacionado':'Gest√£o de Processos (BPM)',Severidade:'Alto',Impacto:'Alto',Categoria:'Escopo','A√ß√£o de Mitiga√ß√£o':'Workshop t√©cnico 18/02',Status:'Aberto'},{ID:'R03',Tipo:'Risco','Descri√ß√£o':'Baixa ades√£o dos usu√°rios finais na Engenharia','Projeto Relacionado':'Gest√£o de Documentos',Severidade:'M√©dio',Impacto:'M√©dio',Categoria:'Ado√ß√£o','A√ß√£o de Mitiga√ß√£o':'Change management em execu√ß√£o',Status:'Mitigando'},{ID:'R04',Tipo:'Risco','Descri√ß√£o':'Depend√™ncia de consultoria externa para BPM avan√ßado','Projeto Relacionado':'Gest√£o de Processos (BPM)',Severidade:'M√©dio',Impacto:'M√©dio',Categoria:'Custo','A√ß√£o de Mitiga√ß√£o':'Capacita√ß√£o interna',Status:'Mitigando'},{ID:'R05',Tipo:'Risco','Descri√ß√£o':'Sobreposi√ß√£o de escopo entre Indicadores e BI','Projeto Relacionado':'Gest√£o de Indicadores',Severidade:'Baixo',Impacto:'Baixo',Categoria:'Escopo','A√ß√£o de Mitiga√ß√£o':'Mapeamento em execu√ß√£o',Status:'Mitigando'},{ID:'I01',Tipo:'Impedimento','Descri√ß√£o':'Aprova√ß√£o de or√ßamento para licen√ßas de Fornecedores','Projeto Relacionado':'Gest√£o de Fornecedores',Severidade:'Alto',Impacto:'Cr√≠tico',Categoria:'Custo','A√ß√£o de Mitiga√ß√£o':'Aguardando Presid√™ncia',Status:'Bloqueado'},{ID:'I02',Tipo:'Impedimento','Descri√ß√£o':'Ambiente de homologa√ß√£o com performance degradada','Projeto Relacionado':'Infraestrutura',Severidade:'M√©dio',Impacto:'M√©dio',Categoria:'Cronograma','A√ß√£o de Mitiga√ß√£o':'Ticket aberto com Softexpert',Status:'Em tratamento'},{ID:'I03',Tipo:'Impedimento','Descri√ß√£o':'Taxonomia corporativa de processos pendente','Projeto Relacionado':'Gest√£o de Processos (BPM)',Severidade:'M√©dio',Impacto:'M√©dio',Categoria:'Escopo','A√ß√£o de Mitiga√ß√£o':'Comit√™ de Processos',Status:'Em tratamento'}],
    'Organograma':[{'N√≠vel':'Sponsor',Papel:'Sponsor',Nome:'Ricardo Santos','Cargo / T√≠tulo':'VP Opera√ß√µes','√Årea':'Opera√ß√µes'},{'N√≠vel':'Comit√™ Executivo',Papel:'Membro',Nome:'Marcelo Ribeiro','Cargo / T√≠tulo':'Diretor de TI','√Årea':'TI'},{'N√≠vel':'Comit√™ Executivo',Papel:'Membro',Nome:'Claudia Souza','Cargo / T√≠tulo':'Diretora de Qualidade','√Årea':'Qualidade'},{'N√≠vel':'Comit√™ Executivo',Papel:'Membro',Nome:'Paulo Figueiredo','Cargo / T√≠tulo':'Diretor Financeiro','√Årea':'Financeiro'},{'N√≠vel':'Gest√£o do Programa',Papel:'Gerente de Programa',Nome:'Lucas Ferreira','Cargo / T√≠tulo':'Gerente de Programa','√Årea':'TI'},{'N√≠vel':'Gest√£o do Programa',Papel:'PMO',Nome:'Daniela Borges','Cargo / T√≠tulo':'Analista de Projetos','√Årea':'TI'},{'N√≠vel':'L√≠der Arquitetura/Infra',Papel:'Consultor',Nome:'Thiago Gomes','Cargo / T√≠tulo':'Consultor Softexpert','√Årea':'Softexpert'},{'N√≠vel':'L√≠der Arquitetura/Infra',Papel:'Infra',Nome:'Rafael Nunes','Cargo / T√≠tulo':'Analista de Infraestrutura','√Årea':'TI'},{'N√≠vel':'Decisor Go-NoGo',Papel:'Decisora',Nome:'Ana Martins','Cargo / T√≠tulo':'Gestora de Qualidade','√Årea':'Qualidade'},{'N√≠vel':'Decisor Go-NoGo',Papel:'Decisora',Nome:'Helena Reis','Cargo / T√≠tulo':'Gestora de Compliance','√Årea':'Compliance'},{'N√≠vel':'Decisor Go-NoGo',Papel:'Decisor',Nome:'Vitor Lima','Cargo / T√≠tulo':'Gestor de Suprimentos','√Årea':'Suprimentos'},{'N√≠vel':'Time Projeto',Papel:'Key User Documentos',Nome:'Ana Martins','√Årea':'Qualidade & Compliance'},{'N√≠vel':'Time Projeto',Papel:'Key User Documentos',Nome:'Beatriz Campos','√Årea':'Qualidade & Compliance'},{'N√≠vel':'Time Projeto',Papel:'Key User NC',Nome:'Carlos Silva','√Årea':'N√£o Conformidades'},{'N√≠vel':'Time Projeto',Papel:'Key User NC',Nome:'Larissa Mendes','√Årea':'N√£o Conformidades'},{'N√≠vel':'Time Projeto',Papel:'Key User BPM',Nome:'Fernanda Rocha','√Årea':'Processos (BPM)'},{'N√≠vel':'Time Projeto',Papel:'Key User BPM',Nome:'Diego Souza','√Årea':'Processos (BPM)'},{'N√≠vel':'Time Projeto',Papel:'Key User Riscos',Nome:'Roberto Almeida','√Årea':'Riscos & Compliance'},{'N√≠vel':'Time Projeto',Papel:'Key User Riscos',Nome:'Camila Prado','√Årea':'Riscos & Compliance'},{'N√≠vel':'Time Projeto',Papel:'Key User Auditorias',Nome:'Patr√≠cia Lima','√Årea':'Auditoria Interna'},{'N√≠vel':'Time Projeto',Papel:'Key User Auditorias',Nome:'Gustavo Teixeira','√Årea':'Auditoria Interna'},{'N√≠vel':'Time Projeto',Papel:'Key User Indicadores',Nome:'Marcos Oliveira','√Årea':'Planejamento Estrat√©gico'},{'N√≠vel':'Time Projeto',Papel:'Key User Indicadores',Nome:'Renata Vieira','√Årea':'Planejamento Estrat√©gico'},{'N√≠vel':'Time Projeto',Papel:'Key User Fornecedores',Nome:'Juliana Costa','√Årea':'Suprimentos'},{'N√≠vel':'Time Projeto',Papel:'Key User Fornecedores',Nome:'Andr√© Barros','√Årea':'Suprimentos'}],
    'RACI':[{Atividade:'Defini√ß√£o de escopo',Sponsor:'A','Comit√™ Exec.':'C','Ger. Programa':'R','L√≠der Arq.':'C','Decisores Go-NoGo':'I','Key Users':'C'},{Atividade:'Configura√ß√£o dos m√≥dulos',Sponsor:'I','Comit√™ Exec.':'I','Ger. Programa':'A','L√≠der Arq.':'C','Decisores Go-NoGo':'I','Key Users':'R'},{Atividade:'Homologa√ß√£o / Testes',Sponsor:'I','Comit√™ Exec.':'I','Ger. Programa':'A','L√≠der Arq.':'C','Decisores Go-NoGo':'C','Key Users':'R'},{Atividade:'Decis√£o de Go-NoGo',Sponsor:'A','Comit√™ Exec.':'C','Ger. Programa':'C','L√≠der Arq.':'I','Decisores Go-NoGo':'R','Key Users':'I'},{Atividade:'Gest√£o de mudan√ßas',Sponsor:'C','Comit√™ Exec.':'A','Ger. Programa':'R','L√≠der Arq.':'I','Decisores Go-NoGo':'I','Key Users':'C'},{Atividade:'Treinamento de usu√°rios',Sponsor:'I','Comit√™ Exec.':'I','Ger. Programa':'A','L√≠der Arq.':'C','Decisores Go-NoGo':'I','Key Users':'R'},{Atividade:'Integra√ß√£o com SAP',Sponsor:'I','Comit√™ Exec.':'C','Ger. Programa':'A','L√≠der Arq.':'R','Decisores Go-NoGo':'I','Key Users':'C'},{Atividade:'Go-Live e estabiliza√ß√£o',Sponsor:'A','Comit√™ Exec.':'I','Ger. Programa':'R','L√≠der Arq.':'C','Decisores Go-NoGo':'C','Key Users':'C'},{Atividade:'Monitoramento de riscos',Sponsor:'I','Comit√™ Exec.':'A','Ger. Programa':'R','L√≠der Arq.':'C','Decisores Go-NoGo':'I','Key Users':'C'},{Atividade:'Aprova√ß√£o de budget',Sponsor:'A','Comit√™ Exec.':'R','Ger. Programa':'C','L√≠der Arq.':'I','Decisores Go-NoGo':'I','Key Users':'I'}],
    'Capacita√ß√£o':[{Indicador:'Key Users Capacitados',Realizado:8,Meta:9},{Indicador:'Usu√°rios Finais Treinados',Realizado:67,Meta:150},{Indicador:'Sess√µes de Treinamento',Realizado:18,Meta:35},{Indicador:'Satisfa√ß√£o (NPS)',Realizado:78,Meta:100}],
    'Budget':[{Categoria:'Licen√ßas Softexpert','Or√ßado (R$)':450000,'Realizado (R$)':420000},{Categoria:'Consultoria & Implanta√ß√£o','Or√ßado (R$)':350000,'Realizado (R$)':280000},{Categoria:'Treinamentos','Or√ßado (R$)':120000,'Realizado (R$)':95000},{Categoria:'Infraestrutura & Integra√ß√£o','Or√ßado (R$)':180000,'Realizado (R$)':155000},{Categoria:'Conting√™ncia','Or√ßado (R$)':100000,'Realizado (R$)':50000},{'M√™s':'Jul/25','Planejado (R$)':80000,'Realizado (R$)':85000},{'M√™s':'Ago/25','Planejado (R$)':90000,'Realizado (R$)':95000},{'M√™s':'Set/25','Planejado (R$)':85000,'Realizado (R$)':75000},{'M√™s':'Out/25','Planejado (R$)':100000,'Realizado (R$)':110000},{'M√™s':'Nov/25','Planejado (R$)':95000,'Realizado (R$)':105000},{'M√™s':'Dez/25','Planejado (R$)':100000,'Realizado (R$)':90000},{'M√™s':'Jan/26','Planejado (R$)':80000,'Realizado (R$)':60000}],
    'Decis√µes':[{Tipo:'Decis√£o','Descri√ß√£o':'Aprovar aloca√ß√£o de 2 recursos adicionais do time de TI para Gest√£o de Riscos','Prazo / Data':'20/02/2026'},{Tipo:'Decis√£o','Descri√ß√£o':'Definir prioridade entre Indicadores e Fornecedores para aloca√ß√£o de key users Q2','Prazo / Data':'28/02/2026'},{Tipo:'Decis√£o','Descri√ß√£o':'Validar or√ßamento adicional de R$ 85K para treinamentos avan√ßados Softexpert','Prazo / Data':'15/03/2026'},{Tipo:'Conquista','Descri√ß√£o':'Gest√£o de Documentos 100% operacional ‚Äî 1.200+ documentos migrados, 45 usu√°rios ativos'},{Tipo:'Conquista','Descri√ß√£o':'Redu√ß√£o de 60% no tempo de busca de documentos'},{Tipo:'Conquista','Descri√ß√£o':'23 processos mapeados em BPM ‚Äî base para automa√ß√£o na Fase 4'},{Tipo:'Conquista','Descri√ß√£o':'100% dos key users capacitados nos m√≥dulos da Fase 2'}]
  });
}

document.addEventListener('DOMContentLoaded', function(){
  carregarPlanilha();
});
</script>
</body>
</html>
